/* Copyright by PaweÅ‚ Klockiewicz; MIT licensed */
$.fn.loadMore=function(e){var t=!1,n=$.extend({containerSelector:"#posts",loadingSelector:"#loading",requestUrl:"objects.php?page=",requestOnStart:!0,requestOnScroll:!1,pagesCount:0,onComplete:null},e);function o(){$(n.loadingSelector).hide()}function r(e){$(e).hide()}function l(e){$(document.body).attr("data-page",e)}function c(e){if(!t){t=!0,$(n.loadingSelector).show(),r(e);var c=parseInt($(document.body).attr("data-page"))+1;$.get(n.requestUrl+c,function(a,i){(o(),l(c),$(e).parent(n.containerSelector).length?$(e).before(a):$(n.containerSelector).append(a),n.pagesCount>0&&n.pagesCount==c)?r(e):(n.requestOnScroll||$(e).show(),$.isFunction(n.onComplete)&&n.onComplete.call(e),t=!1)}).fail(function(){console.log("Can't load content..."),o(),r(e)})}}return this.each(function(){l(0),n.requestOnStart&&c(this),n.requestOnScroll?$(document).on("scroll",function(){var e,t;e=this,t=$(n.containerSelector).outerHeight(),window.innerHeight+$(window).scrollTop()>=t&&c(e)}):$(this).on("click",function(e){e.preventDefault(),c(this)})})};